name: dcat-sparql
version: 1.0.0

mappings:
  - name: harvest
    fetch: ${SOURCE_URL}
    pipeline: rdf
    steps:
      - sparql: harvest/to-molgenis.sparql
      - frame: harvest/output.jsonld
      - mutate: harvest/upsert.gql

  - name: export
    endpoint: /{schema}/api/dcat-sparql
    output: turtle
    steps:
      - sql: export/get-all.sql
      - sparql: export/to-dcat.sparql

  - name: harvest-auto
    fetch: ${SOURCE_URL}
    auto: true
    target: ${TARGET_SCHEMA}
